# 变量


## 关键字 `var`, `let`, `const`

可使用关键字 `var`, `let`, `const` 定义变量.

如:

```javascript
var a = 1;
let b = 2;
const c = 3;
```

`var` 关键字是 英文单词 variable(可变因素, 变量) 的缩写.

我们应不再使用 `var` 关键字, 相应 地方都应替换作 `let`.

用 `let` 定义的变量, 值还可以重新赋值.

用 `const` 定义的是变量不允许再重新赋值.
英文中 const 是"恒定的, 不变的"的意思.

为了代码更不容易出错, 我们习惯于能用const的地方就不用let.


## 变量作用域 & 同一变量不能反复声明

`var` 定义的变量, 作用域是函数使用域, 同一个变量可反复声明.

但 `let`, `const` 声明的变量, 在一个作用域里只能声明一次, 不可反复声明.

反复声明的前提是在同一作用域, 作用域不一样了, 那怕名字一样, 仍然不是同一个变量.

```javascript
var a = 1;
var a = 2; // 这是可以的, var 定义的变量允许反复声明

let b = 3;
// 下面一行是不可以的!  let定义的变量不允许反复声明, 在一个作用域中只允许声明一次, const 同 let
// let b = 4; 

for (let i = 0; i < 10; i++) {
    var a = 5; // 总共只有一个a, 因为 var定义的变量, 只有函数作用域, 没有块级作用域
    let b = 6; // 这里可以的! 总共有两个b, 刚定义的这个变量 b, 在块级作用域中, 所以没有反复声明
}

console.log('a=', a); // 打印出: a=5
console.log('b=', b); // 打印出: b=3  (注意, 这里的b是3而非6, 因为for循环里的b是另外一个b,而非外面的这个b)
```

[注]: 一个函数内部, 产生了一个新的函数作用域; 一对 `{` 和 `}` 产生了一个块级作用域.

```javascript
var d;
// 已经用d定义的变量, 再用let或者const定义都不行
// let d;
```

## 变量先声明, 再使用

变量使用前需要先声明, 任何变量使用前都需要先声明, 否则会报错.

对于 java 等静态语言来说, 如果先使用再声明, 完全可以在执行前通过静态分析得出该错误并提示.
但对于 js 等动态语言来说, 是没有这个静态分析流程的, 如果先使用再声明, 也只能在执行时才能发现.

## 声明提升

声明提升(hoisting)有 var变量声明提升 和 函数声明提升.

```javascript

console.log(a, b); // 这里尝试访问a和b并不会报错, 是因为 变量a和函数b发生了声明提升

var a = 5;
function b () {
    //
}
```

`var a = 5;` 这一条语言其实做了两件事:

1. 声明了一个变量a `var a;`
2. 对变量a进行赋值 `a = 5;`

声明提升, 是指一个函数或者var定义的变量(不针对let, const定义的变量), 其 "声明"部分(不包含"赋值"部分) 会提升到当前作用域的顶部.

注意, 是提升到当前域的顶部. 当然, 这里的作用域也只可能是函数作用域, 而非块级作用域.

上面的那段代码, 实际会被声明提升成如下模块:

```javascript
var a;
var b;
// 因为声明部分可以提升, 所以才会在定义前能够访问变量
// 但能访问也用处不大, 因为还没有正确赋值, 所以能访问不代表着有值和能使用
console.log(a, b); 

a = 5;
b = function b() {
    //
}
```

注意, 仅函数和var定义的变量可以进行声明提升. 对于 类定义什么是是不能进行声明提升的.

使用前, 显示定义变量和函数是一个好习惯, 如下:

```javascript
const add = function (a, b) {
    return a + b;
}

console.log(add(5, 20));
```


## 关于函数

函数声明和变量定义靠得比较近.

下面是一个函数声明语句.
```javascript
function fnName () {
    // ...
}
```

下面是一个变量声明和赋值语句, 变量名是 fnName, 值是一个匿名函数
```javascript
const fnName = function () {
    //...
};
```

赋值给变量的函数, 它的定义中使用的函数名, 可以随意定义, 并不会和外面的冲突.

```javascript
const aUsedName = null;
// 这里赋值给变量fn1的是一个匿名函数
// 可通过 fn1.name 查看当前函数的名字, 名字是 "fn1"
const fn1 = function () {
    //
};

const fn2 = function aUsedName () {
    //
};

// 这里的 aUsedName只是函数的一个表示名, 可通过 fn3.name 查看, 值是 "aUsedName"
const fn3 = function aUsedName () {
    //
};
```


js中的函数也是一种对象, 所以函数和其它对象在本质上是没有区别的.

正如变量的存在意义是为了调用没有名称的对象, 函数名存在的意义是为了调用没有名称的函数.

因此, 变量名和函数名实质上是相同的.
